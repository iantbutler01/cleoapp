# Default values for cleo

# Container registry
image:
  registry: ""  # e.g., ghcr.io/username
  pullPolicy: IfNotPresent

# Public web origin / app domain
# Used for:
# - TWITTER_REDIRECT_URI default
# - CORS origin defaults
app:
  # Frontend origin (scheme + host + optional port, no trailing slash)
  webOrigin: "http://localhost:5173"
  # Callback path registered in Twitter OAuth app
  # (SPA route can be any path; root callback is also supported)
  twitterCallbackPath: "/auth/twitter/callback"
  # Optional explicit CORS origin override (defaults to webOrigin)
  corsOrigin: ""
  # Optional explicit OAuth redirect URI override (defaults to <webOrigin><twitterCallbackPath>)
  twitterRedirectUri: ""
  # Cookie SameSite mode for auth cookies.
  # Use "None" when web and API are different origins.
  cookieSameSite: "Lax"

# API configuration
api:
  image:
    repository: cleo-api
    tag: latest
  replicas: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  env: {}
    # DATABASE_URL: postgres://...
    # TWITTER_CLIENT_ID: ...
    # TWITTER_CLIENT_SECRET: ...
    # JWT_SECRET: ...
    # GOOGLE_GEMINI_API_KEY: ...
    # REDUCTO_API_KEY: ...
  # Local storage for captures (instead of or alongside GCS)
  localStorage:
    enabled: false
    hostPath: ""       # e.g. /home/crow/cleo-data
    mountPath: "/data"
    size: "500Gi"

# Web configuration
web:
  image:
    repository: cleo-web
    tag: latest
  replicas: 1
  # Base URL the web frontend should call for API traffic
  # Can be same-origin (`/api`) or a full origin (`https://api.example.com`)
  apiBaseUrl: "/api"
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"

# Ingress configuration
ingress:
  enabled: true
  className: ""  # e.g., nginx, traefik
  annotations: {}
  # Deprecated but kept for backwards compatibility:
  # when either ingress.api.hosts or ingress.web.hosts is configured, this field is ignored.
  hosts:
    - host: cleo.example.com
      paths:
        - path: /api
          pathType: Prefix
          service: api
        - path: /media
          pathType: Prefix
          service: api
        - path: /auth
          pathType: Prefix
          service: api
        - path: /auth/twitter/callback
          pathType: Prefix
          service: web
        - path: /
          pathType: Prefix
          service: web
  # New split-domain mode (takes precedence over ingress.hosts when host lists are set)
  # Use this when web and api are served from different hosts.
  api:
    hosts: []
    paths:
      - /api
      - /media
      - /auth
  web:
    hosts: []
    # Web hosts serve the SPA at / plus OAuth callback path.
    # The callback path is merged from app.twitterCallbackPath automatically.
    paths:
      - /
  tls: []
  #  - secretName: cleo-tls
  #    hosts:
  #      - cleo.example.com

# External secrets (if using external-secrets operator or sealed-secrets)
externalSecrets:
  enabled: false
  # secretStore: ...

# Service account
serviceAccount:
  create: true
  name: ""
  annotations: {}
